---
layout: default
---

<header class="tags-header">
    <h1 class="tags-title">{{ page.title | default: "Tags" }}</h1>
    <p class="tags-subtitle">Browse {{ site.tags.size }} topics</p>
    <div class="search-wrapper">
        <input type="search" id="tag-search" class="tag-search" placeholder="Search tags..." autocomplete="off">
        <span class="search-icon">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="M21 21l-4.35-4.35"></path>
            </svg>
        </span>
    </div>
</header>

<section class="tags-container">
    {% assign tags = site.tags | sort %}

    <div class="tags-tabs" id="tags-tabs">
        {% for tag in tags %}
        {% assign tag_lower = tag[0] | downcase %}
        {% if tag_lower == 'ohdsi' or tag_lower == 'atlas' or tag_lower == 'achilles' or tag_lower == 'plp' or tag_lower == 'patient-level-prediction' or tag_lower == 'webapi' %}
            {% assign color_class = 'tab-ohdsi' %}
        {% elsif tag_lower == 'fhir' or tag_lower == 'hl7' or tag_lower == 'interoperability' or tag_lower == 'loinc' or tag_lower == 'snomed-ct' %}
            {% assign color_class = 'tab-fhir' %}
        {% elsif tag_lower == 'nlp' or tag_lower == 'biobert' or tag_lower == 'ner' or tag_lower == 'clinical-nlp' or tag_lower == 'healthcare-ai' %}
            {% assign color_class = 'tab-nlp' %}
        {% elsif tag_lower == 'python' or tag_lower == 'docker' or tag_lower == 'streamlit' %}
            {% assign color_class = 'tab-python' %}
        {% elsif tag_lower == 'omop-cdm' or tag_lower == 'omop' or tag_lower == 'etl' or tag_lower == 'clinical-terminologies' or tag_lower == 'data-quality' %}
            {% assign color_class = 'tab-data' %}
        {% elsif tag_lower == 'tutorial' or tag_lower == 'guide' or tag_lower == 'how-to' %}
            {% assign color_class = 'tab-tutorial' %}
        {% else %}
            {% assign color_class = '' %}
        {% endif %}
        <button class="tag-tab {{ color_class }}" data-tag="{{ tag[0] | slugify }}" data-name="{{ tag[0] }}">{{ tag[0] }}<sup>{{ tag[1].size }}</sup></button>{% unless forloop.last %}<span class="tab-divider">|</span>{% endunless %}
        {% endfor %}
    </div>

    <div class="no-results" id="no-results" hidden>
        <p>No tags found matching your search.</p>
    </div>

    <div class="posts-panel" id="posts-panel" hidden>
        <div class="panel-header">
            <span id="panel-tag-name"></span>
            <button class="close-btn" id="close-btn" aria-label="Close panel">&times;</button>
        </div>
        <ul class="posts-list" id="posts-list"></ul>
    </div>
</section>

<!-- JSON data for JavaScript -->
<script type="application/json" id="tags-data">
{
  {% for tag in site.tags %}
  "{{ tag[0] | slugify }}": {
    "name": "{{ tag[0] }}",
    "posts": [
      {% for post in tag[1] %}
      {
        "title": {{ post.title | jsonify }},
        "url": "{{ post.url | relative_url }}",
        "date": "{{ post.date | date: '%b %d' }}"
      }{% unless forloop.last %},{% endunless %}
      {% endfor %}
    ]
  }{% unless forloop.last %},{% endunless %}
  {% endfor %}
}
</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const tagsData = JSON.parse(document.getElementById('tags-data').textContent);
    const searchInput = document.getElementById('tag-search');
    const tagsTabs = document.getElementById('tags-tabs');
    const tagButtons = document.querySelectorAll('.tag-tab');
    const dividers = document.querySelectorAll('.tab-divider');
    const postsPanel = document.getElementById('posts-panel');
    const panelTagName = document.getElementById('panel-tag-name');
    const postsList = document.getElementById('posts-list');
    const closeBtn = document.getElementById('close-btn');
    const noResults = document.getElementById('no-results');

    let activeTag = null;

    // Search filtering
    searchInput.addEventListener('input', function(e) {
        const query = e.target.value.toLowerCase().trim();
        let visibleCount = 0;
        let lastVisibleIndex = -1;

        tagButtons.forEach((btn, index) => {
            const tagName = btn.dataset.tag.toLowerCase();
            const displayName = btn.dataset.name.toLowerCase();
            const matches = tagName.includes(query) || displayName.includes(query);

            btn.classList.toggle('hidden', !matches);
            if (matches) {
                visibleCount++;
                lastVisibleIndex = index;
            }
        });

        // Update divider visibility
        dividers.forEach((div, index) => {
            const prevBtn = tagButtons[index];
            const nextBtn = tagButtons[index + 1];
            const prevVisible = prevBtn && !prevBtn.classList.contains('hidden');
            const nextVisible = nextBtn && !nextBtn.classList.contains('hidden');
            div.classList.toggle('hidden', !prevVisible || !nextVisible);
        });

        noResults.hidden = visibleCount > 0;

        if (activeTag && query) {
            const activeBtn = document.querySelector(`[data-tag="${activeTag}"]`);
            if (activeBtn && activeBtn.classList.contains('hidden')) {
                closePanel();
            }
        }
    });

    // Tag click handler with press animation
    tagButtons.forEach(btn => {
        btn.addEventListener('click', function() {
            const tagSlug = this.dataset.tag;
            const tagInfo = tagsData[tagSlug];

            if (!tagInfo) return;

            // Add press animation
            this.classList.add('pressed');
            setTimeout(() => this.classList.remove('pressed'), 150);

            if (activeTag === tagSlug) {
                closePanel();
                return;
            }

            tagButtons.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            activeTag = tagSlug;

            history.replaceState(null, null, `#${tagSlug}`);

            const postCount = tagInfo.posts.length;
            panelTagName.textContent = `${tagInfo.name} (${postCount})`;

            postsList.innerHTML = tagInfo.posts.map(post => `
                <li><a href="${post.url}">${post.title}</a> <span class="date">${post.date}</span></li>
            `).join('');

            postsPanel.hidden = false;

            setTimeout(() => {
                postsPanel.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 50);
        });
    });

    function closePanel() {
        postsPanel.hidden = true;
        tagButtons.forEach(b => b.classList.remove('active'));
        activeTag = null;
        history.replaceState(null, null, window.location.pathname);
    }

    closeBtn.addEventListener('click', closePanel);

    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && !postsPanel.hidden) {
            closePanel();
        }
    });

    if (window.location.hash) {
        const tagSlug = window.location.hash.slice(1);
        const targetBtn = document.querySelector(`[data-tag="${tagSlug}"]`);
        if (targetBtn) {
            setTimeout(() => targetBtn.click(), 100);
        }
    }

    document.addEventListener('keydown', function(e) {
        if (e.key === '/' && document.activeElement !== searchInput) {
            e.preventDefault();
            searchInput.focus();
        }
    });
});
</script>

<style>
/* Tags Header */
.tags-header {
    text-align: center;
    padding: 40px 24px 30px;
    max-width: var(--max-width);
    margin: 0 auto;
}

.tags-title {
    font-family: var(--font-serif);
    font-size: 2rem;
    font-weight: 600;
    margin-bottom: 6px;
    color: var(--color-text);
}

.tags-subtitle {
    color: var(--color-text-muted);
    font-size: 0.95rem;
    margin-bottom: 20px;
}

/* Search */
.search-wrapper {
    position: relative;
    max-width: 300px;
    margin: 0 auto;
}

.tag-search {
    width: 100%;
    padding: 10px 12px 10px 36px;
    border: 1px solid var(--color-border);
    border-radius: 6px;
    font-size: 0.85rem;
    font-family: var(--font-sans);
    background: var(--color-bg-card);
    color: var(--color-text);
    transition: border-color 0.2s, box-shadow 0.2s;
}

.tag-search:focus {
    outline: none;
    border-color: var(--color-accent);
    box-shadow: 0 0 0 2px rgba(196, 93, 58, 0.1);
}

.tag-search::placeholder {
    color: var(--color-text-muted);
}

.search-icon {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--color-text-muted);
    pointer-events: none;
}

/* Tags Container */
.tags-container {
    max-width: 900px;
    margin: 0 auto;
    padding: 0 24px 40px;
}

/* Tags Tabs - Linear Text Format */
.tags-tabs {
    display: flex;
    flex-wrap: wrap;
    align-items: baseline;
    gap: 0;
    line-height: 2.2;
    margin-bottom: 20px;
    text-align: left;
}

/* Tab Divider */
.tab-divider {
    color: var(--color-border-dark);
    padding: 0 8px;
    font-size: 0.85rem;
    user-select: none;
}

.tab-divider.hidden {
    display: none;
}

/* Tag Tab - Text Button */
.tag-tab {
    background: none;
    border: none;
    cursor: pointer;
    font-family: var(--font-sans);
    font-size: 0.85rem;
    padding: 4px 6px;
    border-radius: 4px;
    color: var(--color-text-secondary);
    transition: all 0.1s ease;
    position: relative;
    white-space: nowrap;
}

.tag-tab sup {
    font-size: 0.6rem;
    opacity: 0.6;
    margin-left: 1px;
}

.tag-tab:hover {
    background: var(--color-bg-alt);
}

/* Press Animation */
.tag-tab.pressed {
    transform: scale(0.95);
}

/* Active State */
.tag-tab.active {
    background: var(--color-text);
    color: var(--color-bg) !important;
    font-weight: 600;
}

.tag-tab.hidden {
    display: none;
}

/* Color-coded tabs - text color */
.tag-tab.tab-ohdsi {
    color: var(--color-ohdsi);
}
.tag-tab.tab-ohdsi:hover {
    background: var(--color-ohdsi-light);
}
.tag-tab.tab-ohdsi.active {
    background: var(--color-ohdsi);
    color: white !important;
}

.tag-tab.tab-fhir {
    color: var(--color-fhir);
}
.tag-tab.tab-fhir:hover {
    background: var(--color-fhir-light);
}
.tag-tab.tab-fhir.active {
    background: var(--color-fhir);
    color: white !important;
}

.tag-tab.tab-nlp {
    color: var(--color-nlp);
}
.tag-tab.tab-nlp:hover {
    background: var(--color-nlp-light);
}
.tag-tab.tab-nlp.active {
    background: var(--color-nlp);
    color: white !important;
}

.tag-tab.tab-data {
    color: var(--color-data);
}
.tag-tab.tab-data:hover {
    background: var(--color-data-light);
}
.tag-tab.tab-data.active {
    background: var(--color-data);
    color: white !important;
}

.tag-tab.tab-python {
    color: var(--color-python);
}
.tag-tab.tab-python:hover {
    background: var(--color-python-light);
}
.tag-tab.tab-python.active {
    background: var(--color-python);
    color: white !important;
}

.tag-tab.tab-tutorial {
    color: var(--color-tutorial);
}
.tag-tab.tab-tutorial:hover {
    background: var(--color-tutorial-light);
}
.tag-tab.tab-tutorial.active {
    background: var(--color-tutorial);
    color: white !important;
}

/* No Results */
.no-results {
    text-align: center;
    padding: 30px 20px;
    color: var(--color-text-muted);
    font-size: 0.9rem;
}

/* Posts Panel - Compact */
.posts-panel {
    background: var(--color-bg-card);
    border: 1px solid var(--color-border);
    border-radius: 8px;
    padding: 16px 20px;
    margin-top: 12px;
    animation: slideDown 0.2s ease-out;
}

.posts-panel[hidden] {
    display: none;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-8px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.panel-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--color-border);
}

.panel-header span {
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--color-text);
}

.close-btn {
    background: none;
    border: none;
    font-size: 1.25rem;
    line-height: 1;
    cursor: pointer;
    color: var(--color-text-muted);
    padding: 2px 6px;
    border-radius: 4px;
    transition: all 0.15s;
}

.close-btn:hover {
    background: var(--color-border);
    color: var(--color-text);
}

/* Posts List - Bulleted, Compact */
.posts-list {
    list-style: disc;
    padding-left: 20px;
    margin: 0;
}

.posts-list li {
    padding: 4px 0;
    font-size: 0.85rem;
    line-height: 1.4;
}

.posts-list li a {
    color: var(--color-text);
    text-decoration: none;
    transition: color 0.15s;
}

.posts-list li a:hover {
    color: var(--color-accent);
    text-decoration: underline;
}

.posts-list .date {
    color: var(--color-text-muted);
    font-size: 0.75rem;
    margin-left: 6px;
}

/* Responsive */
@media (max-width: 600px) {
    .tags-tabs {
        line-height: 2;
    }

    .tag-tab {
        font-size: 0.8rem;
        padding: 3px 4px;
    }

    .tab-divider {
        padding: 0 4px;
    }
}
</style>
