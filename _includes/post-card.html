{% assign first_tag = include.post.tags.first %}
{% assign first_tag_lower = first_tag | downcase %}
{% if first_tag_lower == 'ohdsi' or first_tag_lower == 'atlas' or first_tag_lower == 'achilles' or first_tag_lower == 'plp' or first_tag_lower == 'patient-level-prediction' or first_tag_lower == 'webapi' %}
    {% assign card_class = 'card-ohdsi' %}
    {% assign category_class = 'tag-ohdsi-text' %}
{% elsif first_tag_lower == 'fhir' or first_tag_lower == 'hl7' or first_tag_lower == 'interoperability' %}
    {% assign card_class = 'card-fhir' %}
    {% assign category_class = 'tag-fhir-text' %}
{% elsif first_tag_lower == 'omop-cdm' or first_tag_lower == 'omop' or first_tag_lower == 'etl' or first_tag_lower == 'clinical-terminologies' or first_tag_lower == 'loinc' or first_tag_lower == 'snomed' %}
    {% assign card_class = 'card-data' %}
    {% assign category_class = 'tag-data-text' %}
{% elsif first_tag_lower == 'nlp' or first_tag_lower == 'biobert' or first_tag_lower == 'healthcare-ai' or first_tag_lower == 'ner' or first_tag_lower == 'clinical-nlp' %}
    {% assign card_class = 'card-nlp' %}
    {% assign category_class = 'tag-nlp-text' %}
{% elsif first_tag_lower == 'python' or first_tag_lower == 'docker' or first_tag_lower == 'streamlit' %}
    {% assign card_class = 'card-python' %}
    {% assign category_class = 'tag-python-text' %}
{% elsif first_tag_lower == 'tutorial' or first_tag_lower == 'guide' or first_tag_lower == 'how-to' %}
    {% assign card_class = 'card-tutorial' %}
    {% assign category_class = 'tag-tutorial-text' %}
{% else %}
    {% assign card_class = '' %}
    {% assign category_class = '' %}
{% endif %}
<article class="post-card {{ card_class }}">
    <div class="post-card-header">
        {% if first_tag %}
        <div class="post-card-category {{ category_class }}">{{ first_tag }}</div>
        {% endif %}
        <h3 class="post-card-title">
            <a href="{{ include.post.url | relative_url }}">{{ include.post.title }}</a>
        </h3>
        <p class="post-card-excerpt">{{ include.post.description | default: include.post.excerpt | strip_html | truncate: 160 }}</p>
    </div>
    <div class="post-card-meta">
        <div class="post-card-stats">
            <span>{{ include.post.date | date: "%b %d, %Y" }}</span>
            <span>{% if include.post.reading_time %}{{ include.post.reading_time }}{% else %}{{ include.post.content | number_of_words | divided_by: 200 | plus: 1 }}{% endif %} min read</span>
        </div>
        <a href="{{ include.post.url | relative_url }}" class="read-link">Read â†’</a>
    </div>
    <div class="post-card-tags">
        {% for tag in include.post.tags limit:3 %}
        {% assign tag_lower = tag | downcase %}
        {% assign tag_slug = tag | slugify %}
        {% if tag_lower == 'ohdsi' or tag_lower == 'atlas' or tag_lower == 'achilles' or tag_lower == 'plp' or tag_lower == 'patient-level-prediction' or tag_lower == 'webapi' %}
        <a href="{{ '/tags/#' | append: tag_slug | relative_url }}" class="tag tag-ohdsi">{{ tag }}</a>
        {% elsif tag_lower == 'fhir' or tag_lower == 'hl7' or tag_lower == 'interoperability' or tag_lower == 'loinc' or tag_lower == 'snomed-ct' %}
        <a href="{{ '/tags/#' | append: tag_slug | relative_url }}" class="tag tag-fhir">{{ tag }}</a>
        {% elsif tag_lower == 'nlp' or tag_lower == 'biobert' or tag_lower == 'ner' or tag_lower == 'clinical-nlp' or tag_lower == 'healthcare-ai' %}
        <a href="{{ '/tags/#' | append: tag_slug | relative_url }}" class="tag tag-nlp">{{ tag }}</a>
        {% elsif tag_lower == 'python' or tag_lower == 'docker' or tag_lower == 'streamlit' %}
        <a href="{{ '/tags/#' | append: tag_slug | relative_url }}" class="tag tag-python">{{ tag }}</a>
        {% elsif tag_lower == 'omop-cdm' or tag_lower == 'omop' or tag_lower == 'etl' or tag_lower == 'clinical-terminologies' or tag_lower == 'data-quality' %}
        <a href="{{ '/tags/#' | append: tag_slug | relative_url }}" class="tag tag-data">{{ tag }}</a>
        {% elsif tag_lower == 'tutorial' or tag_lower == 'guide' or tag_lower == 'how-to' %}
        <a href="{{ '/tags/#' | append: tag_slug | relative_url }}" class="tag tag-tutorial">{{ tag }}</a>
        {% else %}
        <a href="{{ '/tags/#' | append: tag_slug | relative_url }}" class="tag">{{ tag }}</a>
        {% endif %}
        {% endfor %}
    </div>
</article>
